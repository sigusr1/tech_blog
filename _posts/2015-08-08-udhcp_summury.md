---
title: "udhcp的几点总结"
date: 2015-08-08  
categories: [网络]
tags: [dhcp]  
---

本文基于busybox 1.23.2 中udhcp的实现，总结几点使用注意事项。
不同客户端、服务器实现可能会有差异。



## DHCP client  ---- udhcpc #

1. -R选项可以让udhcpc进程退出的时候释放ip地址。


## DHCP Server ---- udhcpd #

1. 不会主动释放IP地址，即使原来的租约超时（前提是IP地址还没分配完，或者分配完了但是没有新的客户端请求地址)；
2. 假设IP地址A已经超期，但是DHCP服务器还有剩余IP地址，这时如果有请求，服务器优先分配剩余的IP地址；
3. 假设服务器上没有剩余IP地址，但是有一批超期的IP地址，这时如果有请求，服务器优先分配超时最久的IP地址（即最早分配出去的IP地址）； 
4. 如果一个客户之前申请了IP地址A，然后不再续约，A地址超期； 过了很久该客户又去请求DHCP，如果这时A地址还没分配给其他客户，那么服务器还会分配A地址给该客户； 
5. 释放租约只是把某一项请求的超时时间设置为当前时间，并不会删除该表项；
6. 如果所有的IP地址都分配出去了，并且都没到期，新的请求上来，不再分配IP地址，即使某个IP对应好的客户端已经不在线了(ping不通）。